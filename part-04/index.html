<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Istio - Bookinfo Application | Istio webinar</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/k8s-istio-webinar/favicon.ico">
    <meta name="description" content="Using Istio to control traffic flow without changing your application">
    
    <link rel="preload" href="/k8s-istio-webinar/assets/css/0.styles.76cdea71.css" as="style"><link rel="preload" href="/k8s-istio-webinar/assets/js/app.e120865a.js" as="script"><link rel="preload" href="/k8s-istio-webinar/assets/js/2.7b7d8c54.js" as="script"><link rel="preload" href="/k8s-istio-webinar/assets/js/1.6e3d5e20.js" as="script"><link rel="preload" href="/k8s-istio-webinar/assets/js/10.f92218f8.js" as="script"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/11.3da6bd86.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/12.1edd47ff.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/13.34418c16.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/14.e14a720e.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/15.46f6f98b.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/16.d9227f7e.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/17.0b9f48b5.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/18.ba76edc6.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/19.37c72c39.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/20.3c6764a2.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/21.6a41ea33.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/22.9e744e4a.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/23.1386b505.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/24.735b4ee9.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/25.f4095df3.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/26.55d3f65c.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/27.18c0270c.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/28.a265b921.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/29.d970a03a.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/3.33543ee3.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/30.fda55fdb.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/4.b54801ee.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/5.203cbebb.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/6.d8cb0354.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/7.f1bebbb5.js"><link rel="prefetch" href="/k8s-istio-webinar/assets/js/vendors~docsearch.a43fb3db.js">
    <link rel="stylesheet" href="/k8s-istio-webinar/assets/css/0.styles.76cdea71.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/k8s-istio-webinar/" class="home-link router-link-active"><img src="/k8s-istio-webinar/istio.svg" alt="Istio webinar" class="logo"> <span class="site-name can-hide">Istio webinar</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/k8s-istio-webinar/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Istio links" class="dropdown-title"><span class="title">Istio links</span> <span class="arrow down"></span></button> <button type="button" aria-label="Istio links" class="mobile-dropdown-title"><span class="title">Istio links</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://istio.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Istio
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://istio.io/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Istio docs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/ruzickap/k8s-istio-webinar" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Istio webinar
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/ruzickap/k8s-istio-webinar" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/k8s-istio-webinar/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Istio links" class="dropdown-title"><span class="title">Istio links</span> <span class="arrow down"></span></button> <button type="button" aria-label="Istio links" class="mobile-dropdown-title"><span class="title">Istio links</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://istio.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Istio
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://istio.io/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Istio docs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/ruzickap/k8s-istio-webinar" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Istio webinar
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/ruzickap/k8s-istio-webinar" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/k8s-istio-webinar/" aria-current="page" class="sidebar-link">Istio webinar</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s-istio-webinar/#requirements" class="sidebar-link">Requirements</a></li><li class="sidebar-sub-header"><a href="/k8s-istio-webinar/#objectives" class="sidebar-link">Objectives</a></li><li class="sidebar-sub-header"><a href="/k8s-istio-webinar/#webinar" class="sidebar-link">Webinar</a></li><li class="sidebar-sub-header"><a href="/k8s-istio-webinar/#links" class="sidebar-link">Links</a></li></ul></li><li><a href="/k8s-istio-webinar/part-01/" class="sidebar-link">Create EKS cluster</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s-istio-webinar/part-01/#prepare-the-local-working-environment" class="sidebar-link">Prepare the local working environment</a></li><li class="sidebar-sub-header"><a href="/k8s-istio-webinar/part-01/#configure-aws" class="sidebar-link">Configure AWS</a></li><li class="sidebar-sub-header"><a href="/k8s-istio-webinar/part-01/#create-amazon-eks" class="sidebar-link">Create Amazon EKS</a></li></ul></li><li><a href="/k8s-istio-webinar/part-02/" class="sidebar-link">Install Helm</a></li><li><a href="/k8s-istio-webinar/part-03/" class="sidebar-link">Istio - Installation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s-istio-webinar/part-03/#install-istio" class="sidebar-link">Install Istio</a></li><li class="sidebar-sub-header"><a href="/k8s-istio-webinar/part-03/#create-dns-records" class="sidebar-link">Create DNS records</a></li><li class="sidebar-sub-header"><a href="/k8s-istio-webinar/part-03/#create-ssl-certificate-using-let-s-encrypt" class="sidebar-link">Create SSL certificate using Let's Encrypt</a></li><li class="sidebar-sub-header"><a href="/k8s-istio-webinar/part-03/#check-and-configure-istio" class="sidebar-link">Check and configure Istio</a></li></ul></li><li><a href="/k8s-istio-webinar/part-04/" aria-current="page" class="active sidebar-link">Istio - Bookinfo Application</a></li><li><a href="/k8s-istio-webinar/part-05/" class="sidebar-link">Istio - Configuring Request Routing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s-istio-webinar/part-05/#apply-a-virtual-service" class="sidebar-link">Apply a virtual service</a></li><li class="sidebar-sub-header"><a href="/k8s-istio-webinar/part-05/#route-based-on-user-identity" class="sidebar-link">Route based on user identity</a></li></ul></li><li><a href="/k8s-istio-webinar/part-06/" class="sidebar-link">Istio - Injecting an HTTP delay fault</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s-istio-webinar/part-06/#injecting-an-http-abort-fault" class="sidebar-link">Injecting an HTTP abort fault</a></li></ul></li><li><a href="/k8s-istio-webinar/part-07/" class="sidebar-link">Istio - Weight-based routing</a></li><li><a href="/k8s-istio-webinar/part-08/" class="sidebar-link">Istio - Cleanup</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="istio-bookinfo-application"><a href="#istio-bookinfo-application" class="header-anchor">#</a> Istio - Bookinfo Application</h1> <p>Deploy the demo of <a href="https://istio.io/docs/examples/bookinfo/" target="_blank" rel="noopener noreferrer">Bookinfo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> application:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># kubectl apply -f &lt;(istioctl kube-inject -f samples/bookinfo/platform/kube/bookinfo.yaml)</span>
<span class="token function">tail</span> <span class="token parameter variable">-40</span> samples/bookinfo/platform/kube/bookinfo.yaml
kubectl apply <span class="token parameter variable">-f</span> samples/bookinfo/platform/kube/bookinfo.yaml
</code></pre></div><p>Output:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>---
<span class="token comment">##################################################################################################</span>
<span class="token comment"># Productpage services</span>
<span class="token comment">##################################################################################################</span>
apiVersion: v1
kind: Service
metadata:
  name: productpage
  labels:
    app: productpage
    service: productpage
spec:
  ports:
  - port: <span class="token number">9080</span>
    name: http
  selector:
    app: productpage
---
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: productpage-v1
  labels:
    app: productpage
    version: v1
spec:
  replicas: <span class="token number">1</span>
  template:
    metadata:
      labels:
        app: productpage
        version: v1
    spec:
      containers:
      - name: productpage
        image: istio/examples-bookinfo-productpage-v1:1.10.1
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: <span class="token number">9080</span>
---
</code></pre></div><p>Example with <code>istioctl</code>:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>istioctl kube-inject <span class="token parameter variable">-f</span> samples/bookinfo/platform/kube/bookinfo.yaml <span class="token operator">|</span> <span class="token function">tail</span> <span class="token parameter variable">-172</span>
<span class="token function">sleep</span> <span class="token number">400</span>
</code></pre></div><p>Output:</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">..</span>.
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  creationTimestamp: null
  labels:
    app: productpage
    version: v1
  name: productpage-v1
spec:
  replicas: <span class="token number">1</span>
  strategy: <span class="token punctuation">{</span><span class="token punctuation">}</span>
  template:
    metadata:
      annotations:
        sidecar.istio.io/status: <span class="token string">'{&quot;version&quot;:&quot;1d03c7b8369fddca69b40289a75eabb02e48b68ad5516e6975265f215d382f74&quot;,&quot;initContainers&quot;:[&quot;istio-init&quot;],&quot;containers&quot;:[&quot;istio-proxy&quot;],&quot;volumes&quot;:[&quot;istio-envoy&quot;,&quot;istio-certs&quot;],&quot;imagePullSecrets&quot;:null}'</span>
      creationTimestamp: null
      labels:
        app: productpage
        version: v1
    spec:
      containers:
      - image: istio/examples-bookinfo-productpage-v1:1.10.1
        imagePullPolicy: IfNotPresent
        name: productpage
        ports:
        - containerPort: <span class="token number">9080</span>
        resources: <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">..</span>.
        image: docker.io/istio/proxyv2:1.1.0
        imagePullPolicy: IfNotPresent
        name: istio-proxy
        ports:
        - containerPort: <span class="token number">15090</span>
          name: http-envoy-prom
          protocol: TCP
</code></pre></div><p>The Bookinfo application is broken into four separate microservices:</p> <ul><li><code>productpage</code> - the productpage microservice calls the details and reviews
microservices to populate the page.</li> <li><code>details</code> - the details microservice contains book information.</li> <li><code>reviews</code> - the reviews microservice contains book reviews. It also calls
the ratings microservice.</li> <li><code>ratings</code> - the ratings microservice contains book ranking information
that accompanies a book review.</li></ul> <p>There are 3 versions of the <code>reviews</code> microservice:</p> <ul><li><p>Version <code>v1</code> - doesn't call the <strong>ratings service</strong>.</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAAAsCAIAAADka3H1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAFRUlEQVRoge2XX0hTbRjAn3OOtKOzzXnmQo+a25mLiY0hIRqSmTBQYUhgiTHwoi7Dq278F4R4IaK33TXwpoJs7FhGISKSQdT0IpcQbmf+iZbTsTzq2PTYxfm+fX7usy/3vau+73t/V4ftfZ73eX7b++cQ8XgcMIggf3YB/ymwTZRgmyjBNlGCbaIE20TJr27T6/X29fX97Cq+FyJN983h4eG1tbXf5iAIlUplNpttNhtN08fKs7W1FQqFTp8+nYYa/yAejz979uzdu3exWIxl2cbGxoKCghTyZCCvLEFdXV1lZSUASJIUCoV4nhdFsa2t7VhJlEqlUqlMT4EAAJIkkSQ5NjYWCASuXbumVCpfvHgxMjJy69Ytkjz2wk2jTZqm1Wq1/KzRaGw228OHD+Xqw+Gw2+32+/00TZtMpqamJkmS+vv729vbOY6TQ+7evavX64uKikZHR7u7uwEgOUoUxaGhoa6urqysLEmS7ty5U1FRYbfbAWBmZmZ+fv7GjRs+n+/p06dra2sqlaqysrKmpoYgiCdPnkSj0Z2dHUEQuru7CYKw2+3FxcUAYLPZBgcHw+EwwzDHbfnH7ZskSUqStL+/DwD3799nGKazs/PmzZtfvnzheT4zM7O0tNTr9cqDNzc3l5eXLRbLwQzJUQzDqNXq5eVlAFhdXc3JyREEQR4sCALHcaIojoyMXLhw4fbt2w6H49WrV7OzswBAUdSHDx8MBkNHRwcANDc3GwyGxNQZGRnZ2dmp9JiamuOysbExOTlpMpkoilpZWfn48WNDQ8OJEyeUSmV9ff3c3JwkSWfPnk3YnJ+fz8vLy8/PT2Q4KspgMAQCAQAQBKG8vHx7e3tnZwcAAoEAx3Gzs7Msy1osFpIkdTpdVVWVx+ORE1IUdf78+ZMnTx6sMxqNulyu2tpahUKRQptpXOnPnz+fmJgAgP39/b29vTNnzly+fBkANjY29vb2enp6Dg6ORCJlZWWPHz9eXV1lWdbr9R76Yx4VxXHcmzdvAMDv91dXVweDwaWlJYZhYrFYUVGRx+Px+XydnZ2JEI1GIz8kL+RIJOJ0OktKSi5dupRay39jU96wvofke0xNTc25c+cAIBAIuN3upqYm+TwhCIKm6d7e3uQkRqPR6/VqNBqfzydvfwmOiqIoyuVy7e7uLi0tXb16NRgM+v1+URT1ej1JkgRBmM1mh8ORPFdGxp96//Tpk9PprKqqunjx4ne2/Bc5v/31P7nrZWVlyb8/wzALCwuPHj26fv06QRC5ubnRaDQSichnVCwWi8fjsmiLxTI9Pa3VavPz87Va7cFsR0WpVCq1Wu3xeHJychQKRXFx8fj4+NbWlnyaabXaxcXFRBJRFGmaPuQRAMLh8L179xoaGqxWa8r9wg/bN+12ezAYfPnyJQCwLFtYWMjz/Pb2djQadbvdDx48kIeZzeZQKPT27dtDy/zbUQaDYWZmRr6Tsiz7+fNnQRCMRiMAWK3Wzc3Nqamp3d3dcDjsdDqnp6eTy+N5nuM4vV4f+Z3UruFp3DcPkp2d3djY6HK5TCaTTqdrbW3leX5gYIAkSY7jrly5Ig9TKBSlpaXv379vaWlJTnJUlNFofP36dX19PQBQFKXT6dbX10+dOiXP63A4xsfHJyYmMjMzrVZrbW3tobSxWGxhYQEA5ubmEh+2tbWVl5cft810vQv9P/nV39P/XWCbKME2UYJtogTbRAm2iRJsEyXYJkqwTZRgmyjBNlGCbaIE20QJtokSbBMl2CZKsE2UYJsowTZRgm2iBNtECbaJEmwTJdgmSrBNlHwFGGA5ftmDV+4AAAAASUVORK5CYII=" alt="Bookinfo v1" title="Bookinfo v1"></p></li> <li><p>Version <code>v2</code> - calls the ratings service, and displays each rating as 1 to 5
<strong>black stars</strong>.</p> <p><img src="data:image/png;base64,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" alt="Bookinfo v2" title="Bookinfo v2"></p></li> <li><p>Version <code>v3</code> - calls the ratings service, and displays each rating as 1 to 5
<strong>red stars</strong>.</p> <p><img src="data:image/png;base64,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" alt="Bookinfo v3" title="Bookinfo v3"></p></li></ul> <p><a href="https://istio.io/docs/examples/bookinfo/" target="_blank" rel="noopener noreferrer">Bookinfo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> application architecture:</p> <p><img src="https://raw.githubusercontent.com/istio/istio.io/7bf371365e4a16a9a13c0e79355fe1eac7f8f99f/content/docs/examples/bookinfo/withistio.svg?sanitize=true" alt="Application Architecture with Istio" title="Application Architecture with Istio"></p> <p>Confirm all services and pods are correctly defined and running:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl get svc,deployment,pods <span class="token parameter variable">-o</span> wide
</code></pre></div><p>Output:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>NAME                  TYPE        CLUSTER-IP       EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>    AGE   SELECTOR
service/details       ClusterIP   <span class="token number">10.100</span>.84.225    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">9080</span>/TCP   2m    <span class="token assign-left variable">app</span><span class="token operator">=</span>details
service/kubernetes    ClusterIP   <span class="token number">10.100</span>.0.1       <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">443</span>/TCP    21m   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
service/productpage   ClusterIP   <span class="token number">10.100</span>.111.89    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">9080</span>/TCP   2m    <span class="token assign-left variable">app</span><span class="token operator">=</span>productpage
service/ratings       ClusterIP   <span class="token number">10.100</span>.217.110   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">9080</span>/TCP   2m    <span class="token assign-left variable">app</span><span class="token operator">=</span>ratings
service/reviews       ClusterIP   <span class="token number">10.100</span>.83.162    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">9080</span>/TCP   2m    <span class="token assign-left variable">app</span><span class="token operator">=</span>reviews

NAME                                   DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE   CONTAINERS    IMAGES                                          SELECTOR
deployment.extensions/details-v1       <span class="token number">1</span>         <span class="token number">1</span>         <span class="token number">1</span>            <span class="token number">1</span>           2m    details       istio/examples-bookinfo-details-v1:1.10.1       <span class="token assign-left variable">app</span><span class="token operator">=</span>details,version<span class="token operator">=</span>v1
deployment.extensions/productpage-v1   <span class="token number">1</span>         <span class="token number">1</span>         <span class="token number">1</span>            <span class="token number">1</span>           2m    productpage   istio/examples-bookinfo-productpage-v1:1.10.1   <span class="token assign-left variable">app</span><span class="token operator">=</span>productpage,version<span class="token operator">=</span>v1
deployment.extensions/ratings-v1       <span class="token number">1</span>         <span class="token number">1</span>         <span class="token number">1</span>            <span class="token number">1</span>           2m    ratings       istio/examples-bookinfo-ratings-v1:1.10.1       <span class="token assign-left variable">app</span><span class="token operator">=</span>ratings,version<span class="token operator">=</span>v1
deployment.extensions/reviews-v1       <span class="token number">1</span>         <span class="token number">1</span>         <span class="token number">1</span>            <span class="token number">1</span>           2m    reviews       istio/examples-bookinfo-reviews-v1:1.10.1       <span class="token assign-left variable">app</span><span class="token operator">=</span>reviews,version<span class="token operator">=</span>v1
deployment.extensions/reviews-v2       <span class="token number">1</span>         <span class="token number">1</span>         <span class="token number">1</span>            <span class="token number">1</span>           2m    reviews       istio/examples-bookinfo-reviews-v2:1.10.1       <span class="token assign-left variable">app</span><span class="token operator">=</span>reviews,version<span class="token operator">=</span>v2
deployment.extensions/reviews-v3       <span class="token number">1</span>         <span class="token number">1</span>         <span class="token number">1</span>            <span class="token number">1</span>           2m    reviews       istio/examples-bookinfo-reviews-v3:1.10.1       <span class="token assign-left variable">app</span><span class="token operator">=</span>reviews,version<span class="token operator">=</span>v3

NAME                                  READY   STATUS    RESTARTS   AGE   IP               NODE                                              NOMINATED NODE
pod/details-v1-68868454f5-sphh7       <span class="token number">2</span>/2     Running   <span class="token number">0</span>          2m    <span class="token number">192.168</span>.13.128   ip-192-168-26-217.eu-central-1.compute.internal   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/productpage-v1-5cb458d74f-wwcqc   <span class="token number">2</span>/2     Running   <span class="token number">0</span>          2m    <span class="token number">192.168</span>.76.160   ip-192-168-69-19.eu-central-1.compute.internal    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/ratings-v1-76f4c9765f-lzgpb       <span class="token number">2</span>/2     Running   <span class="token number">0</span>          2m    <span class="token number">192.168</span>.91.69    ip-192-168-69-19.eu-central-1.compute.internal    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/reviews-v1-56f6855586-rnkjj       <span class="token number">2</span>/2     Running   <span class="token number">0</span>          2m    <span class="token number">192.168</span>.77.69    ip-192-168-69-19.eu-central-1.compute.internal    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/reviews-v2-65c9df47f8-sq2vh       <span class="token number">2</span>/2     Running   <span class="token number">0</span>          2m    <span class="token number">192.168</span>.8.68     ip-192-168-26-217.eu-central-1.compute.internal   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/reviews-v3-6cf47594fd-nw8hv       <span class="token number">2</span>/2     Running   <span class="token number">0</span>          2m    <span class="token number">192.168</span>.6.236    ip-192-168-26-217.eu-central-1.compute.internal   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
</code></pre></div><p>Check the container details - you should see also container <code>istio-proxy</code> next
to <code>productpage</code> container.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl describe pod <span class="token parameter variable">-l</span> <span class="token assign-left variable">app</span><span class="token operator">=</span>productpage
</code></pre></div><p>Output:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token punctuation">...</span>
<span class="token key atrule">Containers</span><span class="token punctuation">:</span>
  <span class="token key atrule">productpage</span><span class="token punctuation">:</span>
    <span class="token key atrule">Container ID</span><span class="token punctuation">:</span>   docker<span class="token punctuation">:</span>//62984fbf7913e8cd91e5188571c7efad781880966a0d9b36279f368ad9cbf2a0
    <span class="token key atrule">Image</span><span class="token punctuation">:</span>          istio/examples<span class="token punctuation">-</span>bookinfo<span class="token punctuation">-</span>productpage<span class="token punctuation">-</span>v1<span class="token punctuation">:</span>1.10.1
<span class="token punctuation">...</span>
  <span class="token key atrule">istio-proxy</span><span class="token punctuation">:</span>
    <span class="token key atrule">Container ID</span><span class="token punctuation">:</span>  docker<span class="token punctuation">:</span>//17a2c6c87b1e8f315417b284973452332ea34162543af46776075ad1f43db327
    <span class="token key atrule">Image</span><span class="token punctuation">:</span>         docker.io/istio/proxyv2<span class="token punctuation">:</span>1.1.0
<span class="token punctuation">...</span>
</code></pre></div><p>The <code>kubectl logs</code> command will show you the output of the envoy proxy
(<code>istio-proxy</code>):</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl logs <span class="token variable"><span class="token variable">$(</span>kubectl get pod <span class="token parameter variable">-l</span> <span class="token assign-left variable">app</span><span class="token operator">=</span>productpage <span class="token parameter variable">-o</span> <span class="token assign-left variable">jsonpath</span><span class="token operator">=</span><span class="token string">&quot;{.items[0].metadata.name}&quot;</span><span class="token variable">)</span></span> istio-proxy <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-70</span>
</code></pre></div><p>Output:</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">..</span>.
<span class="token number">2019</span>-03-29T09:49:07.660863Z     info    Effective config: binaryPath: /usr/local/bin/envoy
concurrency: <span class="token number">2</span>
configPath: /etc/istio/proxy
connectTimeout: 10s
discoveryAddress: istio-pilot.istio-system:15010
drainDuration: 45s
parentShutdownDuration: 60s
proxyAdminPort: <span class="token number">15000</span>
serviceCluster: productpage.default
statNameLength: <span class="token number">189</span>
tracing:
  zipkin:
    address: zipkin.istio-system:9411

<span class="token number">2019</span>-03-29T09:49:07.660886Z     info    Monitored certs: <span class="token punctuation">[</span><span class="token punctuation">]</span>envoy.CertSource<span class="token punctuation">{</span>envoy.CertSource<span class="token punctuation">{</span>Directory:<span class="token string">&quot;/etc/certs/&quot;</span>, Files:<span class="token punctuation">[</span><span class="token punctuation">]</span>string<span class="token punctuation">{</span><span class="token string">&quot;cert-chain.pem&quot;</span>, <span class="token string">&quot;key.pem&quot;</span>, <span class="token string">&quot;root-cert.pem&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token number">2019</span>-03-29T09:49:07.660896Z     info    PilotSAN <span class="token punctuation">[</span><span class="token punctuation">]</span>string<span class="token punctuation">(</span>nil<span class="token punctuation">)</span>
<span class="token number">2019</span>-03-29T09:49:07.660996Z     info    Opening status port <span class="token number">15020</span>

<span class="token number">2019</span>-03-29T09:49:07.661159Z     info    Starting proxy agent
<span class="token number">2019</span>-03-29T09:49:07.661340Z     info    Received new config, resetting budget
<span class="token number">2019</span>-03-29T09:49:07.661349Z     info    Reconciling retry <span class="token punctuation">(</span>budget <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token number">2019</span>-03-29T09:49:07.661359Z     info    Epoch <span class="token number">0</span> starting
<span class="token number">2019</span>-03-29T09:49:07.662335Z     info    Envoy command: <span class="token punctuation">[</span>-c /etc/istio/proxy/envoy-rev0.json --restart-epoch <span class="token number">0</span> --drain-time-s <span class="token number">45</span> --parent-shutdown-time-s <span class="token number">60</span> --service-cluster productpage.default --service-node sidecar~192.168.76.160~productpage-v1-5cb458d74f-wwcqc.default~default.svc.cluster.local --max-obj-name-len <span class="token number">189</span> --allow-unknown-fields <span class="token parameter variable">-l</span> warning <span class="token parameter variable">--concurrency</span> <span class="token number">2</span><span class="token punctuation">]</span>
<span class="token punctuation">..</span>.
</code></pre></div><p>Define the <a href="https://istio.io/docs/reference/config/networking/gateway/" target="_blank" rel="noopener noreferrer">Istio gateway<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
for the application:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cat</span> samples/bookinfo/networking/bookinfo-gateway.yaml
kubectl apply <span class="token parameter variable">-f</span> samples/bookinfo/networking/bookinfo-gateway.yaml
<span class="token function">sleep</span> <span class="token number">5</span>
</code></pre></div><p>Output:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.istio.io/v1alpha3
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Gateway
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> bookinfo<span class="token punctuation">-</span>gateway
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">istio</span><span class="token punctuation">:</span> ingressgateway <span class="token comment"># use istio default controller</span>
  <span class="token key atrule">servers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span>
      <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">80</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> http
      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> HTTP
    <span class="token key atrule">hosts</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;*&quot;</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.istio.io/v1alpha3
<span class="token key atrule">kind</span><span class="token punctuation">:</span> VirtualService
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> bookinfo
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token string">&quot;*&quot;</span>
  <span class="token key atrule">gateways</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> bookinfo<span class="token punctuation">-</span>gateway
  <span class="token key atrule">http</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">match</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">uri</span><span class="token punctuation">:</span>
        <span class="token key atrule">exact</span><span class="token punctuation">:</span> /productpage
    <span class="token punctuation">-</span> <span class="token key atrule">uri</span><span class="token punctuation">:</span>
        <span class="token key atrule">exact</span><span class="token punctuation">:</span> /login
    <span class="token punctuation">-</span> <span class="token key atrule">uri</span><span class="token punctuation">:</span>
        <span class="token key atrule">exact</span><span class="token punctuation">:</span> /logout
    <span class="token punctuation">-</span> <span class="token key atrule">uri</span><span class="token punctuation">:</span>
        <span class="token key atrule">prefix</span><span class="token punctuation">:</span> /api/v1/products
    <span class="token key atrule">route</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">destination</span><span class="token punctuation">:</span>
        <span class="token key atrule">host</span><span class="token punctuation">:</span> productpage
        <span class="token key atrule">port</span><span class="token punctuation">:</span>
          <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">9080</span>
</code></pre></div><p>Create and display default <a href="https://istio.io/docs/reference/config/networking/destination-rule/" target="_blank" rel="noopener noreferrer">destination rules<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
(subsets) for the Bookinfo services:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl apply <span class="token parameter variable">-f</span> samples/bookinfo/networking/destination-rule-all.yaml
kubectl get destinationrules <span class="token parameter variable">-o</span> yaml
</code></pre></div><p>Display the destination rules:</p> <p>Output:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token punctuation">...</span>
<span class="token punctuation">-</span> <span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.istio.io/v1alpha3
  <span class="token key atrule">kind</span><span class="token punctuation">:</span> DestinationRule
<span class="token punctuation">...</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> reviews
    <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token punctuation">...</span>
  <span class="token key atrule">spec</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> reviews
    <span class="token key atrule">subsets</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">version</span><span class="token punctuation">:</span> v1
      <span class="token key atrule">name</span><span class="token punctuation">:</span> v1
    <span class="token punctuation">-</span> <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">version</span><span class="token punctuation">:</span> v2
      <span class="token key atrule">name</span><span class="token punctuation">:</span> v2
    <span class="token punctuation">-</span> <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">version</span><span class="token punctuation">:</span> v3
      <span class="token key atrule">name</span><span class="token punctuation">:</span> v3
<span class="token punctuation">...</span>
</code></pre></div><p>Confirm the gateway and virtualsevice has been created:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl get gateway,virtualservice,destinationrule
</code></pre></div><p>Output:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>NAME                                           AGE
gateway.networking.istio.io/bookinfo-gateway   13s

NAME                                          GATEWAYS             HOSTS   AGE
virtualservice.networking.istio.io/bookinfo   <span class="token punctuation">[</span>bookinfo-gateway<span class="token punctuation">]</span>   <span class="token punctuation">[</span>*<span class="token punctuation">]</span>     13s

NAME                                              HOST          AGE
destinationrule.networking.istio.io/details       details       8s
destinationrule.networking.istio.io/productpage   productpage   8s
destinationrule.networking.istio.io/ratings       ratings       8s
destinationrule.networking.istio.io/reviews       reviews       8s
</code></pre></div><p><img src="https://raw.githubusercontent.com/istio/istio.io/92bc65af57592294102e1bc2cb13b333b44a73e0/content/blog/2018/v1alpha3-routing/virtualservices-destrules.svg?sanitize=true" alt="Gateway -&gt; VirtualService -&gt; DestinationRule" title="Gateway -&gt; VirtualService -&gt; DestinationRule"></p> <p>Check the SSL certificate:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token operator">|</span> openssl s_client <span class="token parameter variable">-showcerts</span> <span class="token parameter variable">-connect</span> <span class="token variable">${MY_DOMAIN}</span>:443 <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">|</span> openssl x509 <span class="token parameter variable">-inform</span> pem <span class="token parameter variable">-noout</span> <span class="token parameter variable">-text</span>
</code></pre></div><p>Output:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>Certificate:
    Data:
        Version: <span class="token number">3</span> <span class="token punctuation">(</span>0x2<span class="token punctuation">)</span>
        Serial Number:
            03:ba:eb:a2:34:43:0c:ae:7b:63:64:4d:4a:ee:c1:25:b4:35
    Signature Algorithm: sha256WithRSAEncryption
        Issuer: C <span class="token operator">=</span> US, O <span class="token operator">=</span> Let<span class="token string">'s Encrypt, CN = Let'</span>s Encrypt Authority X3
        Validity
            Not Before: Mar <span class="token number">29</span> 08:46:52 <span class="token number">2019</span> GMT
            Not After <span class="token builtin class-name">:</span> Jun <span class="token number">27</span> 08:46:52 <span class="token number">2019</span> GMT
        Subject: CN <span class="token operator">=</span> *.mylabs.dev
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: <span class="token punctuation">(</span><span class="token number">2048</span> bit<span class="token punctuation">)</span>
                Modulus:
<span class="token punctuation">..</span>.
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature, Key Encipherment
            X509v3 Extended Key Usage:
                TLS Web Server Authentication, TLS Web Client Authentication
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Subject Key Identifier:
                AB:60:E9:ED:3F:40:72:83:7D:62:08:F9:EB:8F:EA:1C:42:CC:76:4E
            X509v3 Authority Key Identifier:
                keyid:A8:4A:6A:63:04:7D:DD:BA:E6:D1:39:B7:A6:45:65:EF:F3:A8:EC:A1

            Authority Information Access:
                OCSP - URI:http://ocsp.int-x3.letsencrypt.org
                CA Issuers - URI:http://cert.int-x3.letsencrypt.org/

            X509v3 Subject Alternative Name:
                DNS:*.mylabs.dev, DNS:mylabs.dev
            X509v3 Certificate Policies:
                Policy: <span class="token number">2.23</span>.140.1.2.1
                Policy: <span class="token number">1.3</span>.6.1.4.1.44947.1.1.1
                  CPS: http://cps.letsencrypt.org
<span class="token punctuation">..</span>.
</code></pre></div><p>You can see it in the certificate transparency log: <a href="https://crt.sh/?q=mylabs.dev" target="_blank" rel="noopener noreferrer">https://crt.sh/?q=mylabs.dev<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</p> <p><img src="/k8s-istio-webinar/assets/img/crt_sh.62999733.png" alt="crt.sh Certificate" title="crt.sh Certificate"></p> <p>SSL Certificate in Kiali <a href="https://kiali.mylabs.dev" target="_blank" rel="noopener noreferrer">https://kiali.mylabs.dev<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
web page:</p> <p><img src="/k8s-istio-webinar/assets/img/kiali_ssl_certificate.666bf9f2.png" alt="Kiali SSL Certificate displayed in browser" title="Kiali SSL Certificate displayed in browser"></p> <p>You can also use the <a href="https://github.com/jetstack/cert-manager" target="_blank" rel="noopener noreferrer">cert-manager<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
directly to see the status of the certificate:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl describe certificates ingress-cert-<span class="token variable">${LETSENCRYPT_ENVIRONMENT}</span> <span class="token parameter variable">-n</span> istio-system
</code></pre></div><p>Output:</p> <div class="language-text extra-class"><pre class="language-text"><code>Name:         ingress-cert-production
Namespace:    istio-system
Labels:       &amp;lt;none&gt;
Annotations:  kubectl.kubernetes.io/last-applied-configuration:
                {&quot;apiVersion&quot;:&quot;certmanager.k8s.io/v1alpha1&quot;,&quot;kind&quot;:&quot;Certificate&quot;,&quot;metadata&quot;:{&quot;annotations&quot;:{},&quot;name&quot;:&quot;ingress-cert-production&quot;,&quot;namespace&quot;...
API Version:  certmanager.k8s.io/v1alpha1
Kind:         Certificate
Metadata:
  Creation Timestamp:  2019-03-29T09:43:02Z
  Generation:          1
  Resource Version:    2854
  Self Link:           /apis/certmanager.k8s.io/v1alpha1/namespaces/istio-system/certificates/ingress-cert-production
  UID:                 0b677790-5207-11e9-ac06-02dc9c152bfa
Spec:
  Acme:
    Config:
      Dns 01:
        Provider:  aws-route53
      Domains:
        *.mylabs.dev
        mylabs.dev
  Common Name:  *.mylabs.dev
  Dns Names:
    *.mylabs.dev
    mylabs.dev
  Issuer Ref:
    Kind:       ClusterIssuer
    Name:       letsencrypt-production-dns
  Secret Name:  ingress-cert-production
Status:
  Conditions:
    Last Transition Time:  2019-03-29T09:46:53Z
    Message:               Certificate is up to date and has not expired
    Reason:                Ready
    Status:                True
    Type:                  Ready
  Not After:               2019-06-27T08:46:52Z
Events:
  Type     Reason          Age                  From          Message
  ----     ------          ----                 ----          -------
  Warning  IssuerNotReady  9m9s (x2 over 9m9s)  cert-manager  Issuer letsencrypt-production-dns not ready
  Normal   Generated       9m8s                 cert-manager  Generated new private key
  Normal   OrderCreated    9m8s                 cert-manager  Created Order resource &quot;ingress-cert-production-3383842614&quot;
  Normal   OrderComplete   5m18s                cert-manager  Order &quot;ingress-cert-production-3383842614&quot; completed successfully
  Normal   CertIssued      5m18s                cert-manager  Certificate issued successfully
</code></pre></div><p><img src="https://raw.githubusercontent.com/jetstack/cert-manager/4f30ed75e88e5d0defeb950501b5cac6da7fa7fe/docs/images/high-level-overview.png" alt="cert-manager high level overview" title="cert-manager high level overview"></p> <p>Confirm the app is running:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token parameter variable">-o</span> /dev/null <span class="token parameter variable">-s</span> <span class="token parameter variable">-w</span> <span class="token string">&quot;%{http_code}&quot;</span> http://<span class="token variable">${MY_DOMAIN}</span>/productpage<span class="token punctuation">;</span> <span class="token builtin class-name">echo</span>
</code></pre></div><p>Output:</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token number">200</span>
</code></pre></div><p>Generate some traffic for next 5 minutes to gather some data for monitoring:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>siege <span class="token parameter variable">--log</span><span class="token operator">=</span>/tmp/siege <span class="token parameter variable">--concurrent</span><span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-q</span> <span class="token parameter variable">--internet</span> <span class="token parameter variable">--time</span><span class="token operator">=</span>10M http://<span class="token variable">${MY_DOMAIN}</span>/productpage <span class="token operator">&amp;&gt;</span> /dev/null <span class="token operator">&amp;</span>
</code></pre></div><p>In case of DNS issue you can use the services exposed on ports directly from
loadbalancer:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl <span class="token parameter variable">-n</span> istio-system get <span class="token function">service</span> istio-ingressgateway <span class="token parameter variable">-o</span> <span class="token assign-left variable">jsonpath</span><span class="token operator">=</span><span class="token string">&quot;{.status.loadBalancer.ingress[0].hostname}&quot;</span><span class="token punctuation">;</span> <span class="token builtin class-name">echo</span>
</code></pre></div><p>Output:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>abd0be556520611e9ac0602dc9c152bf-2144127322.eu-central-1.elb.amazonaws.com
</code></pre></div><ul><li>Kiali: <code>http://&lt;IP ADDRESS OF CLUSTER INGRESS&gt;:15029</code></li> <li>Prometheus: <code>http://&lt;IP ADDRESS OF CLUSTER INGRESS&gt;:15030</code></li> <li>Grafana: <code>http://&lt;IP ADDRESS OF CLUSTER INGRESS&gt;:15031</code></li> <li>Tracing: <code>http://&lt;IP ADDRESS OF CLUSTER INGRESS&gt;:15032</code></li></ul> <p>Open the Bookinfo site in your browser <a href="http://mylabs.dev/productpage" target="_blank" rel="noopener noreferrer">http://mylabs.dev/productpage<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
and refresh the page several times - you should see different versions
of reviews shown in productpage, presented in a <strong>round robin style</strong>
(red stars, black stars, no stars), since we haven't yet used Istio to control
the version routing.</p> <p><img src="/k8s-istio-webinar/assets/img/bookinfo_v1_v3_v2.d76ff3b4.gif" alt="Bookinfo v1, v3, v2" title="Bookinfo v1, v3, v2"></p> <p>Check the flows in <a href="https://kiali.mylabs.dev/console/graph/namespaces/?edges=requestsPercentOfTotal&amp;graphType=versionedApp&amp;namespaces=default&amp;injectServiceNodes=true&amp;duration=60&amp;pi=5000&amp;layout=dagre" target="_blank" rel="noopener noreferrer">Kiali<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <p><img src="/k8s-istio-webinar/assets/img/istio_kiali_graph.5f2d46a7.gif" alt="Istio Graph" title="Istio Graph"></p> <p>Open the browser with these pages:</p> <ul><li><p>Servicegraph:</p> <ul><li><p><a href="https://servicegraph.mylabs.dev/force/forcegraph.html" target="_blank" rel="noopener noreferrer">https://servicegraph.mylabs.dev/force/forcegraph.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/k8s-istio-webinar/assets/img/servicegraph_istio_service_graph.fc558d6e.png" alt="Istio Service Graph" title="Istio Service Graph"></p></li> <li><p><a href="https://servicegraph.mylabs.dev/dotviz" target="_blank" rel="noopener noreferrer">https://servicegraph.mylabs.dev/dotviz<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/k8s-istio-webinar/assets/img/servicegraph_dotviz.9fd85b88.png" alt="Service Graph - dotviz" title="Service Graph - dotviz"></p></li></ul></li> <li><p><a href="https://www.kiali.io/" target="_blank" rel="noopener noreferrer">Kiali<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <ul><li><p><a href="https://kiali.mylabs.dev" target="_blank" rel="noopener noreferrer">https://kiali.mylabs.dev<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (admin/admin)</p> <p><img src="/k8s-istio-webinar/assets/img/kiali.836b5bd9.png" alt="Kiali" title="Kiali"></p></li></ul></li> <li><p><a href="https://www.jaegertracing.io/" target="_blank" rel="noopener noreferrer">Jaeger<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <ul><li><p><a href="https://jaeger.mylabs.dev" target="_blank" rel="noopener noreferrer">https://jaeger.mylabs.dev<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/k8s-istio-webinar/assets/img/jaeger.337c5009.png" alt="Jaeger" title="Jaeger"></p></li></ul></li> <li><p><a href="https://prometheus.io/" target="_blank" rel="noopener noreferrer">Prometheus<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <ul><li><p><a href="https://prometheus.mylabs.dev/graph?g0.range_input=1h&amp;g0.expr=istio_requests_total&amp;g0.tab=0" target="_blank" rel="noopener noreferrer">https://prometheus.mylabs.dev/graph?g0.range_input=1h&amp;g0.expr=istio_requests_total&amp;g0.tab=0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/k8s-istio-webinar/assets/img/prometheus_istio_requests_total1.940c7a1e.png" alt="Prometheus - istio_requests_total" title="Prometheus - istio_requests_total"></p></li> <li><p>Total count of all requests to the productpage service:</p> <ul><li><p><a href="https://prometheus.mylabs.dev/graph?g0.range_input=1h&amp;g0.expr=istio_requests_total%7Bdestination_service%3D%22productpage.default.svc.cluster.local%22%7D&amp;g0.tab=0" target="_blank" rel="noopener noreferrer">https://prometheus.mylabs.dev/graph?g0.range_input=1h&amp;g0.expr=istio_requests_total%7Bdestination_service%3D%22productpage.default.svc.cluster.local%22%7D&amp;g0.tab=0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/k8s-istio-webinar/assets/img/prometheus_istio_requests_total2.0cc234e0.png" alt="Prometheus - istio_requests_total" title="Prometheus - istio_requests_total"></p></li></ul></li> <li><p>Total count of all requests to <code>v1</code> of the reviews service:</p> <ul><li><p><a href="https://prometheus.mylabs.dev/graph?g0.range_input=1h&amp;g0.expr=istio_requests_total%7Bdestination_service%3D%22reviews.default.svc.cluster.local%22%2C%20destination_version%3D%22v1%22%7D&amp;g0.tab=0" target="_blank" rel="noopener noreferrer">https://prometheus.mylabs.dev/graph?g0.range_input=1h&amp;g0.expr=istio_requests_total%7Bdestination_service%3D%22reviews.default.svc.cluster.local%22%2C%20destination_version%3D%22v1%22%7D&amp;g0.tab=0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/k8s-istio-webinar/assets/img/prometheus_istio_requests_total3.0b522b0d.png" alt="Prometheus - istio_requests_total" title="Prometheus - istio_requests_total"></p></li></ul></li> <li><p>Rate of requests over the past 5 minutes to all instances of the productpage
service:</p> <ul><li><p><a href="https://prometheus.mylabs.dev/graph?g0.range_input=1h&amp;g0.expr=rate(istio_requests_total%7Bdestination_service%3D~%22productpage.*%22%2C%20response_code%3D%22200%22%7D%5B5m%5D)&amp;g0.tab=0" target="_blank" rel="noopener noreferrer">https://prometheus.mylabs.dev/graph?g0.range_input=1h&amp;g0.expr=rate(istio_requests_total%7Bdestination_service%3D~%22productpage.*%22%2C%20response_code%3D%22200%22%7D%5B5m%5D)&amp;g0.tab=0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/k8s-istio-webinar/assets/img/prometheus_istio_requests_total4.43a1d944.png" alt="Prometheus - istio_requests_total" title="Prometheus - istio_requests_total"></p></li></ul></li></ul></li> <li><p><a href="https://grafana.com/" target="_blank" rel="noopener noreferrer">Grafana<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <ul><li><p><a href="https://grafana.mylabs.dev" target="_blank" rel="noopener noreferrer">https://grafana.mylabs.dev<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>Grafana -&gt; Home -&gt; Istio -&gt;</p> <ul><li><p>Istio Performance Dashboard</p> <p><img src="/k8s-istio-webinar/assets/img/grafana_istio_performance_dashboard.f8890998.png" alt="Grafana - Istio Performance Dashboard" title="Grafana - Istio Performance Dashboard"></p></li> <li><p>Istio Service Dashboard</p> <p><img src="/k8s-istio-webinar/assets/img/grafana_istio_service_dashboard.23cdab30.png" alt="Grafana - Istio Service Dashboard" title="Grafana - Istio Service Dashboard"></p></li> <li><p>Istio Workload Dashboard</p> <p><img src="/k8s-istio-webinar/assets/img/grafana_istio_workload_dashboard.4fa52776.png" alt="Grafana - Istio Workload Dashboard" title="Grafana - Istio Workload Dashboard"></p></li> <li><p>Istio Galley Dashboard</p> <p><img src="/k8s-istio-webinar/assets/img/grafana_istio_galley_dashboard.af903931.png" alt="Grafana - Galley Dashboard" title="Grafana - Galley Dashboard"></p></li> <li><p>Istio Mixer Dashboard</p> <p><img src="/k8s-istio-webinar/assets/img/grafana_istio_mixer_dashboard.ccd84584.png" alt="Grafana - Mixer Dashboard" title="Grafana - Mixer Dashboard"></p></li> <li><p>Istio Pilot Dashboard</p> <p><img src="/k8s-istio-webinar/assets/img/grafana_istio_pilot_dashboard.083e833c.png" alt="Grafana - Pilot Dashboard" title="Grafana - Pilot Dashboard"></p></li></ul></li></ul></li></ul> <p><img src="/k8s-istio-webinar/assets/img/istio.a24267ed.svg" alt="Istio" title="Istio"></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ruzickap/k8s-istio-webinar/edit/master/docs/part-04/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/30/2024, 2:40:33 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/k8s-istio-webinar/part-03/" class="prev">
        Istio - Installation
      </a></span> <span class="next"><a href="/k8s-istio-webinar/part-05/">
        Istio - Configuring Request Routing
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/k8s-istio-webinar/assets/js/app.e120865a.js" defer></script><script src="/k8s-istio-webinar/assets/js/2.7b7d8c54.js" defer></script><script src="/k8s-istio-webinar/assets/js/1.6e3d5e20.js" defer></script><script src="/k8s-istio-webinar/assets/js/10.f92218f8.js" defer></script>
  </body>
</html>
