(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{249:function(s,t,a){s.exports=a.p+"assets/img/istio.a24267ed.svg"},344:function(s,t,a){"use strict";a.r(t);var e=a(8),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"istio-installation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#istio-installation"}},[s._v("#")]),s._v(" Istio - Installation")]),s._v(" "),t("p",[s._v("Istio architecture:")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/istio/istio.io/7bf371365e4a16a9a13c0e79355fe1eac7f8f99f/content/docs/concepts/what-is-istio/arch.svg?sanitize=true",alt:"Istio Architecture",title:"Istio Architecture"}})]),s._v(" "),t("h2",{attrs:{id:"install-istio"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-istio"}},[s._v("#")]),s._v(" Install Istio")]),s._v(" "),t("p",[s._v("Either download Istio directly from "),t("a",{attrs:{href:"https://github.com/istio/istio/releases",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/istio/istio/releases"),t("OutboundLink")],1),s._v("\nor get the latest version by using curl:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ISTIO_VERSION")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.1.0"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" tmp "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" tmp\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" tmp\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-sL")]),s._v(" https://git.io/getLatestIstio "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" -\n")])])]),t("p",[s._v("Output:")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("Downloading istio-1.1.0 from https://github.com/istio/istio/releases/download/1.1.0/istio-1.1.0-linux.tar.gz "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("614")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("614")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("884")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" --:--:-- --:--:-- --:--:--   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("883")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".0M  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(".0M    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  5252k      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00:02  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00:02 --:--:-- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(".4M\nDownloaded into istio-1.1.0:\nLICENSE  README.md  bin  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("  istio.VERSION  samples  tools\nAdd /mnt/k8s-istio-webinar/k8s-istio-webinar/tmp/istio-1.1.0/bin to your path"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" e.g copy "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("paste")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" your shell and/or ~/.profile:\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v(':/mnt/k8s-istio-webinar/k8s-istio-webinar/tmp/istio-1.1.0/bin"')]),s._v("\n")])])]),t("p",[s._v("Change the directory to the Istio installation files location:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" istio*\n")])])]),t("p",[s._v("Install "),t("code",[s._v("istioctl")]),s._v(":")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-x")]),s._v(" /usr/local/bin/istioctl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" bin/istioctl /usr/local/bin/\n")])])]),t("p",[s._v("Install the "),t("code",[s._v("istio-init")]),s._v(" chart to bootstrap all the Istio's CRDs:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("helm "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" install/kubernetes/helm/istio-init "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--wait")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" istio-init "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--namespace")]),s._v(" istio-system "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("certmanager.enabled")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("\n")])])]),t("p",[s._v("Install "),t("a",{attrs:{href:"https://istio.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Istio"),t("OutboundLink")],1),s._v(" with add-ons ("),t("a",{attrs:{href:"https://www.kiali.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kiali"),t("OutboundLink")],1),s._v(",\n"),t("a",{attrs:{href:"https://www.jaegertracing.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Jaeger"),t("OutboundLink")],1),s._v(", "),t("a",{attrs:{href:"https://grafana.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Grafana"),t("OutboundLink")],1),s._v(",\n"),t("a",{attrs:{href:"https://prometheus.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Prometheus"),t("OutboundLink")],1),s._v(", "),t("a",{attrs:{href:"https://github.com/jetstack/cert-manager",target:"_blank",rel:"noopener noreferrer"}},[s._v("cert-manager"),t("OutboundLink")],1),s._v("):")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("helm "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" install/kubernetes/helm/istio "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--wait")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" istio "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--namespace")]),s._v(" istio-system "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("certmanager.enabled")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("certmanager.email")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("petr.ruzicka@gmail.com "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" gateways.istio-ingressgateway.sds.enabled"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("global.k8sIngress.enabled")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("global.k8sIngress.enableHttps")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("global.k8sIngress.gatewayName")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ingressgateway "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("grafana.enabled")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("kiali.enabled")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("kiali.createDemoSecret")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("kiali.contextPath")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("kiali.dashboard.grafanaURL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://grafana."),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${MY_DOMAIN}")]),s._v("/ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("kiali.dashboard.jaegerURL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://jaeger."),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${MY_DOMAIN}")]),s._v("/ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("servicegraph.enabled")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tracing.enabled")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n")])])]),t("h2",{attrs:{id:"create-dns-records"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-dns-records"}},[s._v("#")]),s._v(" Create DNS records")]),s._v(" "),t("p",[s._v("Create DNS record "),t("code",[s._v("mylabs.dev")]),s._v(" for the loadbalancer created by Istio:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LOADBALANCER_HOSTNAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl get svc istio-ingressgateway "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" istio-system "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{.status.loadBalancer.ingress[0].hostname}"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CANONICAL_HOSTED_ZONE_NAME_ID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("aws elb describe-load-balancers "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--query")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"LoadBalancerDescriptions[?DNSName==\\'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("$LOADBALANCER_HOSTNAME"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v('].CanonicalHostedZoneNameID"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--output")]),s._v(" text"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HOSTED_ZONE_ID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("aws route53 list-hosted-zones "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--query")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"HostedZones[?Name==\\'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("MY_DOMAIN"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v('].Id"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--output")]),s._v(" text"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\nenvsubst "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/files/aws_route53-dns_change.json "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" aws route53 change-resource-record-sets --hosted-zone-id "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HOSTED_ZONE_ID}")]),s._v(" --change-batch"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("file:///dev/stdin\n")])])]),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/aws-samples/eks-workshop/65b766c494a5b4f5420b2912d8373c4957163541/static/images/crystal.svg?sanitize=true",alt:"Architecture",title:"Architecture"}})]),s._v(" "),t("h2",{attrs:{id:"create-ssl-certificate-using-let-s-encrypt"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-ssl-certificate-using-let-s-encrypt"}},[s._v("#")]),s._v(" Create SSL certificate using Let's Encrypt")]),s._v(" "),t("p",[s._v("Create "),t("code",[s._v("ClusterIssuer")]),s._v(" and "),t("code",[s._v("Certificate")]),s._v(" for Route53 used by cert-manager.\nIt will allow Let's encrypt to generate certificate. Route53 (DNS) method of\nrequesting certificate from Let's Encrypt must be used to create wildcard\ncertificate "),t("code",[s._v("*.mylabs.dev")]),s._v(" (details "),t("a",{attrs:{href:"https://community.letsencrypt.org/t/wildcard-certificates-via-http-01/51223",target:"_blank",rel:"noopener noreferrer"}},[s._v("here"),t("OutboundLink")],1),s._v(").")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("EKS_CERT_MANAGER_ROUTE53_AWS_SECRET_ACCESS_KEY_BASE64")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$EKS_CERT_MANAGER_ROUTE53_AWS_SECRET_ACCESS_KEY")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" base64"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/files/cert-manager-letsencrypt-aws-route53-clusterissuer-certificate.yaml\nenvsubst "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/files/cert-manager-letsencrypt-aws-route53-clusterissuer-certificate.yaml "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" kubectl apply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" -\n")])])]),t("p",[t("img",{attrs:{src:"https://b3n.org/wp-content/uploads/2016/09/acme_letsencrypt_dns-01-challenge.png",alt:"ACME DNS Challenge",title:"ACME DNS Challenge"}})]),s._v(" "),t("p",[s._v("("),t("a",{attrs:{href:"https://b3n.org/intranet-ssl-certificates-using-lets-encrypt-dns-01/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://b3n.org/intranet-ssl-certificates-using-lets-encrypt-dns-01/"),t("OutboundLink")],1),s._v(")")]),s._v(" "),t("p",[s._v("Let "),t("code",[s._v("istio-ingressgateway")]),s._v(" to use cert-manager generated certificate via\n"),t("a",{attrs:{href:"https://www.envoyproxy.io/docs/envoy/v1.5.0/intro/arch_overview/service_discovery#arch-overview-service-discovery-types-sds",target:"_blank",rel:"noopener noreferrer"}},[s._v("SDS"),t("OutboundLink")],1),s._v(".\nSteps are taken from here "),t("a",{attrs:{href:"https://istio.io/docs/tasks/traffic-management/ingress/ingress-certmgr/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://istio.io/docs/tasks/traffic-management/ingress/ingress-certmgr/"),t("OutboundLink")],1),s._v(".")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" istio-system patch gateway istio-autogenerated-k8s-ingress "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--type")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("json "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[{"')]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("op")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('": "')]),s._v("replace"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('", "')]),s._v("path"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('": "')]),s._v("/spec/servers/1/tls"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('", "')]),s._v("value"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('": {"')]),s._v("credentialName"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('": "')]),s._v("ingress-cert-"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${LETSENCRYPT_ENVIRONMENT}")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('", "')]),s._v("mode"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('": "')]),s._v("SIMPLE"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('", "')]),s._v("privateKey"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('": "')]),s._v("sds"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('", "')]),s._v("serverCertificate"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('": "')]),s._v("sds"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"}}]"')]),s._v("\n")])])]),t("h2",{attrs:{id:"check-and-configure-istio"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#check-and-configure-istio"}},[s._v("#")]),s._v(" Check and configure Istio")]),s._v(" "),t("p",[s._v("Allow the "),t("code",[s._v("default")]),s._v(" namespace to use Istio injection:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl label namespace default istio-injection"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("enabled\n")])])]),t("p",[s._v("Check namespaces:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl get namespace "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-L")]),s._v(" istio-injection\n")])])]),t("p",[s._v("Output:")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("NAME           STATUS   AGE   ISTIO-INJECTION\ndefault        Active   19m   enabled\nistio-system   Active   7m\nkube-public    Active   19m\nkube-system    Active   19m\n")])])]),t("p",[s._v("See the Istio components:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl get "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--namespace")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("istio-system svc,deployment,pods,job,horizontalpodautoscaler,destinationrule\n")])])]),t("p",[s._v("Output:")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("NAME                             TYPE           CLUSTER-IP       EXTERNAL-IP                                                                  PORT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                                                                                                      AGE\nservice/grafana                  ClusterIP      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".84.93     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v("/TCP                                                                                                                                     7m\nservice/istio-citadel            ClusterIP      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".203.5     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8060")]),s._v("/TCP,15014/TCP                                                                                                                           7m\nservice/istio-galley             ClusterIP      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".224.231   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("/TCP,15014/TCP,9901/TCP                                                                                                                   7m\nservice/istio-ingressgateway     LoadBalancer   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".241.162   abd0be556520611e9ac0602dc9c152bf-2144127322.eu-central-1.elb.amazonaws.com   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":31380/TCP,443:31390/TCP,31400:31400/TCP,15029:31705/TCP,15030:30101/TCP,15031:30032/TCP,15032:32493/TCP,15443:31895/TCP,15020:31909/TCP   7m\nservice/istio-pilot              ClusterIP      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".68.4      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15010")]),s._v("/TCP,15011/TCP,8080/TCP,15014/TCP                                                                                                       7m\nservice/istio-policy             ClusterIP      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".24.13     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9091")]),s._v("/TCP,15004/TCP,15014/TCP                                                                                                                 7m\nservice/istio-sidecar-injector   ClusterIP      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".252.24    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("/TCP                                                                                                                                      7m\nservice/istio-telemetry          ClusterIP      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".103.164   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9091")]),s._v("/TCP,15004/TCP,15014/TCP,42422/TCP                                                                                                       7m\nservice/jaeger-agent             ClusterIP      None             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5775")]),s._v("/UDP,6831/UDP,6832/UDP                                                                                                                   7m\nservice/jaeger-collector         ClusterIP      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".32.192    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14267")]),s._v("/TCP,14268/TCP                                                                                                                          7m\nservice/jaeger-query             ClusterIP      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".196.113   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16686")]),s._v("/TCP                                                                                                                                    7m\nservice/kiali                    ClusterIP      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".66.131    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20001")]),s._v("/TCP                                                                                                                                    7m\nservice/prometheus               ClusterIP      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".246.253   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9090")]),s._v("/TCP                                                                                                                                     7m\nservice/servicegraph             ClusterIP      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".163.157   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8088")]),s._v("/TCP                                                                                                                                     7m\nservice/tracing                  ClusterIP      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".90.197    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/TCP                                                                                                                                       7m\nservice/zipkin                   ClusterIP      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".8.55      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9411")]),s._v("/TCP                                                                                                                                     7m\n\nNAME                                           DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE\ndeployment.extensions/certmanager              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           7m\ndeployment.extensions/grafana                  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           7m\ndeployment.extensions/istio-citadel            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           7m\ndeployment.extensions/istio-galley             "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           7m\ndeployment.extensions/istio-ingressgateway     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           7m\ndeployment.extensions/istio-pilot              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           7m\ndeployment.extensions/istio-policy             "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           7m\ndeployment.extensions/istio-sidecar-injector   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           7m\ndeployment.extensions/istio-telemetry          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           7m\ndeployment.extensions/istio-tracing            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           7m\ndeployment.extensions/kiali                    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           7m\ndeployment.extensions/prometheus               "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           7m\ndeployment.extensions/servicegraph             "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           7m\n\nNAME                                          READY   STATUS      RESTARTS   AGE\npod/certmanager-7478689867-6n8r7              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7m\npod/grafana-7b46bf6b7c-w7ms2                  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7m\npod/istio-citadel-75fdb679db-v8bqh            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7m\npod/istio-galley-c864b5c86-8xfpm              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7m\npod/istio-ingressgateway-6cb65d86cb-5ptgp     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7m\npod/istio-init-crd-10-stcw2                   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/1     Completed   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7m\npod/istio-init-crd-11-fgdh9                   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/1     Completed   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7m\npod/istio-init-crd-certmanager-10-rhmv9       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/1     Completed   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7m\npod/istio-init-crd-certmanager-11-dv24d       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/1     Completed   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7m\npod/istio-pilot-f4c98cfbf-pwp45               "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7m\npod/istio-policy-6cbbd844dd-4dzbx             "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("          7m\npod/istio-sidecar-injector-7b47cb4689-5x7ph   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7m\npod/istio-telemetry-ccc4df498-w77hk           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("          7m\npod/istio-tracing-75dd89b8b4-frg8w            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7m\npod/kiali-7787748c7d-lb454                    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7m\npod/prometheus-89bc5668c-54pdj                "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          7m\npod/servicegraph-5d4b49848-cscbp              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("          7m\n\nNAME                                      DESIRED   SUCCESSFUL   AGE\njob.batch/istio-init-crd-10               "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            7m\njob.batch/istio-init-crd-11               "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            7m\njob.batch/istio-init-crd-certmanager-10   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            7m\njob.batch/istio-init-crd-certmanager-11   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            7m\n\nNAME                                                       REFERENCE                         TARGETS         MINPODS   MAXPODS   REPLICAS   AGE\nhorizontalpodautoscaler.autoscaling/istio-ingressgateway   Deployment/istio-ingressgateway   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("unknown"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/80%   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("          7m\nhorizontalpodautoscaler.autoscaling/istio-pilot            Deployment/istio-pilot            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("unknown"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/80%   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("          7m\nhorizontalpodautoscaler.autoscaling/istio-policy           Deployment/istio-policy           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("unknown"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/80%   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("          7m\nhorizontalpodautoscaler.autoscaling/istio-telemetry        Deployment/istio-telemetry        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("unknown"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/80%   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("          7m\n\nNAME                                                  HOST                                             AGE\ndestinationrule.networking.istio.io/istio-policy      istio-policy.istio-system.svc.cluster.local      7m\ndestinationrule.networking.istio.io/istio-telemetry   istio-telemetry.istio-system.svc.cluster.local   7m\n")])])]),t("p",[s._v("Configure the Istio services ("),t("a",{attrs:{href:"https://www.jaegertracing.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Jaeger"),t("OutboundLink")],1),s._v(",\n"),t("a",{attrs:{href:"https://prometheus.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Prometheus"),t("OutboundLink")],1),s._v(", "),t("a",{attrs:{href:"https://grafana.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Grafana"),t("OutboundLink")],1),s._v(",\n"),t("a",{attrs:{href:"https://www.kiali.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kiali"),t("OutboundLink")],1),s._v(", Servicegraph) to be visible externally:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("envsubst "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/files/export_services_gateway.yaml "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" kubectl apply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" -\n")])])]),t("p",[t("img",{attrs:{src:a(249),alt:"Istio",title:"Istio"}})])])}),[],!1,null,null,null);t.default=r.exports}}]);